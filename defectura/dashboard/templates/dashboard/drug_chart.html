{% extends 'base.html' %}

{% block title %} –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö {% endblock %}

{% block content %}
 <div class="col-md-12 mb-lg-0 mb-4">
    <div class="card mt-4 shadow-sm border-0">
        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
            <h6 class="mb-0" style="color:white;">üìà –î–∏–Ω–∞–º–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ –ø—Ä–µ–ø–∞—Ä–∞—Ç—É: {{ drug_name }}</h6>
        </div>
        <div class="card-body">
            <div class="col-6">
                <div class="row">
                    <canvas id="drugChart" width="600" height="300"></canvas>
                </div>
            </div>
            <h5>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–µ–ø–∞—Ä–∞—Ç—É: {{ drug_name }}</h5>

            <!-- –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º–∞—è —Ç–∞–±–ª–∏—Ü–∞ -->
            <div style="overflow-x: auto; max-width: 100%;">
                <table class="table table-bordered text-center">
                    <thead>
                        <tr>
                            <th>–î–∞—Ç–∞</th>
                            {% for date in dates %}
                                <th>{{ date }}</th>
                            {% endfor %}
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>–ß–∏—Å–ª–æ –∞–ø—Ç–µ–∫ —Å –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–º</td>
                            {% for item in with_data %}
                                <td>{{ item }}</td>
                            {% endfor %}
                        </tr>
                        <tr>
                            <td>–ê–ø—Ç–µ–∫–∏ —Å –¥–µ—Ñ–µ–∫—Ç—É—Ä–æ–π</td>
                            {% for item in without_data %}
                                <td>{{ item }}</td>
                            {% endfor %}
                        </tr>
                        <tr>
                            <td>–î–∏–Ω–∞–º–∏–∫–∞ —Å–æ –≤—á–µ—Ä–∞—à–Ω–∏–º –¥–Ω–µ–º</td>
                            {% for diff in dynamics %}
                                <td>
                                    {% if diff is not None %}
                                        <span style="color:
                                            {% if diff > 0 %}green
                                            {% elif diff < 0 %}red
                                            {% else %}gray
                                            {% endif %}
                                        ">
                                            {% if diff > 0 %}+{% endif %}{{ diff }}
                                        </span>
                                    {% else %}
                                        ‚Äî
                                    {% endif %}
                                </td>
                            {% endfor %}
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>





<div class="col-md-12 mb-lg-0 mb-4">
    <div class="card mt-4 shadow-sm border-0">
        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
            <h6 class="mb-0" style="color:white;">üìà –ë–∞–∑–∞ –∞–ø—Ç–µ–∫ –∏ —Ñ–∞—Ä–º–∞—Ü–µ–≤—Ç–æ–≤ –∏ –Ω–∞–ª–∏—á–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞</h6>
        </div>
        <div class="card-body">
            <!-- –ü–µ—Ä–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞: –ë–∞–∑–∞ –∞–ø—Ç–µ–∫ –∏ —Ñ–∞—Ä–º–∞—Ü–µ–≤—Ç–æ–≤ -->
            <h5>üìä –ë–∞–∑–∞ –∞–ø—Ç–µ–∫ –∏ —Ñ–∞—Ä–º–∞—Ü–µ–≤—Ç–æ–≤ (–∏–∑ –±–∞–∑—ã –§–ö)</h5>
            <table class="table table-bordered text-center">
                <thead>
                    <tr>
                        <th>–ü–æ–ª–µ</th>
                        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                        <th>–ê–¥—Ä–µ—Å</th>
                        <th>–°–µ—Ç—å (—Ä—É–∫–∞–º–∏)</th>
                        <th>–¢–µ–ª–µ—Ñ–æ–Ω(—ã)</th>
                        <th>–§–∞—Ä–º–∞—Ü–µ–≤—Ç—ã –∞–ø—Ç–µ–∫–∏</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>–ê–ø—Ç–µ–∫–∞ 1</td>
                        <td>–ê–¥—Ä–µ—Å 1</td>
                        <td>–°–µ—Ç—å 1</td>
                        <td>–¢–µ–ª–µ—Ñ–æ–Ω 1</td>
                        <td>–§–∏–æ 1, –§–∏–æ 2</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>–ê–ø—Ç–µ–∫–∞ 2</td>
                        <td>–ê–¥—Ä–µ—Å 2</td>
                        <td>–°–µ—Ç—å 2</td>
                        <td>–¢–µ–ª–µ—Ñ–æ–Ω 2</td>
                        <td>–§–∏–æ 3, –§–∏–æ 4</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>–ê–ø—Ç–µ–∫–∞ 3</td>
                        <td>–ê–¥—Ä–µ—Å 3</td>
                        <td>–°–µ—Ç—å 3</td>
                        <td>–¢–µ–ª–µ—Ñ–æ–Ω 3</td>
                        <td>–§–∏–æ 5, –§–∏–æ 6</td>
                    </tr>
                </tbody>
            </table>

            <!-- –í—Ç–æ—Ä–∞—è —Ç–∞–±–ª–∏—Ü–∞: –ù–∞–ª–∏—á–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞ –Ω–∞ —Å–µ—Ç–µ–≤–æ–º —Å–∫–ª–∞–¥–µ -->
            <h5>üìä –ù–∞–ª–∏—á–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞ –Ω–∞ —Å–µ—Ç–µ–≤–æ–º —Å–∫–ª–∞–¥–µ (—Ä—É—á–Ω–∞—è –º–æ–¥–µ—Ä–∞—Ü–∏—è)</h5>
            <table class="table table-bordered text-center">
                <thead>
                    <tr>
                        <th>–°–µ—Ç—å (–ü—Ä–µ–ø–∞—Ä–∞—Ç)</th>
                        <th>–î–∞—Ç–∞ (1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é)</th>
                        <th>–î–∞—Ç–∞ (1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>–ê–¥–µ–ª—å</td>
                        <td>100 —É–ø</td>
                        <td>90 —É–ø</td>
                    </tr>
                    <tr>
                        <td>–ò–Ω—Ç–µ—Ä—Ñ–∞—Ä–º–∞–∫—Å</td>
                        <td>80 —É–ø</td>
                        <td>75 —É–ø</td>
                    </tr>
                    <tr>
                        <td>–ë–µ–ª—Ñ–∞—Ä–º–∞—Ü–∏—è</td>
                        <td>120 —É–ø</td>
                        <td>110 —É–ø</td>
                    </tr>
                </tbody>
            </table>

        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const ctx = document.getElementById('drugChart').getContext('2d');
    const chart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: {{ labels|safe }},
            datasets: [{
                label: '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∞–ø—Ç–µ–∫ –±–µ–∑ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞',
                data: {{ data|safe }},
                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                borderColor: 'rgba(75, 192, 192, 1)',
                borderWidth: 2,
                tension: 0.3
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∞–ø—Ç–µ–∫'
                    }
                },
                x: {
                    title: {
                        display: true,
                        text: '–î–∞—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞'
                    }
                }
            }
        }
    });
</script>
{% endblock %}
